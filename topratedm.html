<!DOCTYPE html>
<html lang="en">
    <head>
        <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
        <link rel="stylesheet" href="pagnation.css">
        <link rel="stylesheet" href="main.css">
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.16.0/umd/popper.min.js"></script>
        <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta charset="utf-8">
        <title>UMNFlix</title>
    </head>
    <body  style="background-color: #0f0f0f;">
        <div class="jumbotron header">
          <image src="umnflix.png"></image>
          <h2 class="umnflix">UMNFlix</h2>
        </div>
        <nav class="navbar navbar-dark bg-primary navbar navbar-expand" style="position:relative; top:-35px;color:white; background-color:  #2321bf;">
            <ul class="navbar-nav mr-auto">
                <li class="nav-item"><a class="nav-link" href="index.html">Home</a></li>
                <li class="nav-item dropdown">
                    <a class="nav-link dropdown-toggle active" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">Movies</a>
                    <div class="dropdown-menu">
                        <a class="dropdown-item" href="topratedm.html">Top Rated</a>
                        <a class="dropdown-item" href="upcoming.html">Upcoming</a>
                        <a class="dropdown-item" href="nowplay.html">Now Playing</a>
                        <a class="dropdown-item" href="mpopular.html">Popular</a>
                    </div>
                </li>
                <li class="nav-item dropdown">
                    <a class="nav-link dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">TV Shows</a>
                    <div class="dropdown-menu">
                        <a class="dropdown-item" href="toptv.html">Top Rated</a>
                        <a class="dropdown-item" href="tvonair.html">On the air</a>
                        <a class="dropdown-item" href="tvtoday.html">Airing Today</a>
                        <a class="dropdown-item" href="tvpopular.html">Popular</a>
                    </div>
                </li>
                <li class="nav-item"><a class="nav-link" href="favorite.html">MyFav</a></li>
                <li class="nav-item"><a class="nav-link" href="about.html">About Us</a></li>
            </ul>
            <form class="form-inline">
                <input class="form-control" type="search" placeholder="Search" aria-label="Search">
                <button class="btn btn-outline-success" type="submit">Search</button>
            </form>
        </nav>
        <h1 id="header" class="text-center" style="margin-top:2.5%; margin-bottom: 2.5%; color:white;">Top Movies</h1>
        <nav id="pagi1" aria-label="Page navigation">
            <ul class="pagination justify-content-center">
              <li class="page-item">
                <a class="page-link" href="" aria-label="Previous">
                  <span aria-hidden="true">&laquo;</span>
                  <span class="sr-only">Previous</span>
                </a>
              </li>
              <li class="page-item active"><a class="page-link" href="#">1</a></li>
              <li class="page-item"><a class="page-link" href="topratedm2.html">2</a></li>
              <li class="page-item"><a class="page-link" href="topratedm3.html">3</a></li>
              <li class="page-item">
                <a class="page-link" href="topratedm2.html" aria-label="Next">
                  <span aria-hidden="true">&raquo;</span>
                  <span class="sr-only">Next</span>
                </a>
              </li>
            </ul>
          </nav>
          <div id="not"></div>
          <div id="show" style="margin-left:7%;">
            <div style="display: inline-flex; flex-wrap: wrap;" id="topmovielist">
          </div>
          </div>
        <nav id="pagi2" aria-label="Page navigation">
            <ul class="pagination justify-content-center">
              <li class="page-item">
                <a class="page-link" href="" aria-label="Previous">
                  <span aria-hidden="true">&laquo;</span>
                  <span class="sr-only">Previous</span>
                </a>
              </li>
              <li class="page-item active"><a class="page-link" href="#">1</a></li>
              <li class="page-item"><a class="page-link" href="topratedm2.html">2</a></li>
              <li class="page-item"><a class="page-link" href="topratedm3.html">3</a></li>
              <li class="page-item">
                <a class="page-link" href="topratedm2.html" aria-label="Next">
                  <span aria-hidden="true">&raquo;</span>
                  <span class="sr-only">Next</span>
                </a>
              </li>
            </ul>
          </nav>
          <footer class="footer py-3"style="background-color: #0d253f;">
            <div class="container2">
                <span class="text-white font-weight-bold">Powered by: </span><br>
                <img src="Asset 3.svg" class="img-fluid pt-3" style="max-width: fit-content;" alt="">
            </div>
         </footer>
    </body>
    <script>
      for(var g = 1;g <= 100; g++){
        $.get('https://api.themoviedb.org/3/movie/top_rated?api_key=b6372c2fe49139b540aacffecdb59c55&language=en-US&page='+ g, function(data){
            for(i = 0; i < 20; i++){
                    var tambah = '<div class="card" style=" background-color:#1a1919; width: 16rem; margin-bottom:1%; margin-right:1.5%;"><img src= "http://image.tmdb.org/t/p/original/' + data.results[i].poster_path + '" class="card-img-top imageprofile"><div class="card-body"><h2 id="original_title" class="card-title" style="color:#b31c12;">' + data.results[i].original_title + '</h2><hr><p style="color: white;">'+ data.results[i].overview +'</p><h5 id="idmovie" hidden>'+ data.results[i].id  +'</h5><h5 style="color: yellowgreen;">Vote : ' + data.results[i].vote_average + '<h5 style="color: yellowgreen;">Popularity : ' + data.results[i].popularity + '</h5></h5><h5 style="color:yellow;">Release Date : '+ data.results[i].release_date +'</h5></div><button id="buttonfavouritemovie">Add to Favourite</button></div>'
                    $("#topmovielist").append(tambah);
                };
            });
      }

      $('.form-inline').submit(function(e){
        e.preventDefault();
        var pencarian = $('.form-control').val();

        const namamovie = pencarian;
        const api = "&api_key=b6372c2fe49139b540aacffecdb59c55";
        const link = "https://api.themoviedb.org/3/search/movie?query=" + pencarian + api;

        console.log(link);
        $.get(link,function(datasearch){
          $("#pagi1").remove();
          $("#pagi2").remove();
          $("#topmovielist").remove();
          $("#show").append('<div style="display: inline-flex; flex-wrap: wrap;" id="topmovielist">');
            if(datasearch.results.length > 0){
            for(i = 0; i < datasearch.results.length; i++){
                    var ganti = '<div class="card fmstyle" style=" background-color:#1a1919; width: 16rem; margin-bottom:1%; margin-right:1.5%;"><img src= "http://image.tmdb.org/t/p/original' + datasearch.results[i].poster_path + '" class="card-img-top imageprofile"><div class="card-body"><h2 id="original_title" class="card-title" style="color:#b31c12;">' + datasearch.results[i].original_title + '</h2><hr><p style="color: white;">'+ datasearch.results[i].overview +'</p><h5 id="idmovie" hidden>'+ datasearch.results[i].id  +'</h5><h5 style="color: yellowgreen;">Vote : ' + datasearch.results[i].vote_average + '<h5 style="color: yellowgreen;">Popularity : ' + datasearch.results[i].popularity + '</h5></h5><h5 style="color:yellow;">Release Date : '+ datasearch.results[i].release_date +'</h5></div><button id="buttonfavouritemovie">Add to Favourite</button></div>'
                    $("#topmovielist").append(ganti);
                    $("#header").html('Movie Show Results : ' + pencarian );
                };
          }
          else if(datasearch.results.length == 0){
            var ganti = '<h5 class="text-center" style="color:red;"> Movie Not Available </h5>';
                    $("#not").append(ganti);
                    $("#header").html('Movie Show Results : ' + pencarian );
              }
            });
        });

        $('#show').on('click','#buttonfavouritemovie',function(){ 
            let id = $(this).parent().find("#idmovie").text();
            let baselink = "https://api.themoviedb.org/3/movie/";
            let api = "?api_key=b6372c2fe49139b540aacffecdb59c55";
            let linkfavorite = baselink + id + api;
            var old_data = JSON.parse(localStorage.getItem('simpanlinkmovie'));
            old_data.push(linkfavorite);
            alert("added to favorite");
            localStorage.setItem('simpanlinkmovie', JSON.stringify(old_data))
            console.log(old_data);
        });
      </script>
</html>
